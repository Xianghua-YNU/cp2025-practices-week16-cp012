# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** [严佳伟] 

**学号：** [20231050183] 

**完成日期：** [25.6.13]

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

显式差分法是将偏微分方程离散化为有限差分方程，通过显式地计算每个时间步长下一个空间点的温度值来求解热传导问题的方法。其基本思想是利用泰勒展开将时间导数和空间二阶导数进行离散化，得到以下差分公式：
![image](https://github.com/user-attachments/assets/41448e5d-c44a-41e9-bded-fc034dd967d1)

整理得

![image](https://github.com/user-attachments/assets/5413c082-70ff-4551-9970-8943d91f312b)

其中 r=αΔt/Δx^2。显式差分法的稳定性条件要求 r≤0.5，否则数值解会出现振荡发散现象。


### 2.2 关键代码片段
```python
# 显式差分法核心代码
r = D * dt / (dx ** 2)
print(f"稳定性参数 r = {r}")
    
u = np.zeros((Nx, Nt))
u[:, 0] = 100  # 初始温度设为100℃
u[0, :] = 0    # 左端温度保持0℃
u[-1, :] = 0   # 右端温度保持0℃
    
for j in range(Nt-1):
    u[1:-1, j+1] = (1-2*r)*u[1:-1, j] + r*(u[2:, j] + u[:-2, j])
```

## 3. 实验结果

### 3.1 显式差分法数值解

![image](https://github.com/user-attachments/assets/0431a60f-91e6-466c-a74d-f19b60905316)


### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

![image](https://github.com/user-attachments/assets/84eacf41-1bc3-4b81-9b12-7f4511231fbc)

### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

![image](https://github.com/user-attachments/assets/0536591d-d7dc-47ea-bd21-f5fc08b737c9)


### 3.4 不同初始条件模拟

![image](https://github.com/user-attachments/assets/fced7c9b-91c4-4294-84cf-ff132b9137a1)


### 3.5 包含牛顿冷却定律的模拟
![image](https://github.com/user-attachments/assets/d41b3533-7c31-4727-9aa3-a6624e3af617)


## 4. 分析与讨论

1. **稳定性问题：** 在实现显式差分法时，若不满足稳定性条件 r≤0.5，即时间步长过大或空间步长过小，会导致数值解出现振荡发散现象。这是由于显式差分法的 truncation error 和 numerical amplification factor 共同作用的结果。当 r>0.5 时，数值解的误差会在时间推进过程中不断放大，最终导致解的发散。
2. **精度问题：** 显式差分法的精度主要受限于空间步长和时间步长的大小。一般来说，减小空间步长和时间步长可以提高数值解的精度，但这会增加计算量和存储需求。在实际应用中，需要在精度和计算效率之间进行权衡。此外，显式差分法的精度还可以通过采用更高阶的差分格式或优化算法来进一步提高。
## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
 显式差分法在 r>0.5 时产生数值振荡的原因在于其 numerical amplification factor 的模大于1。根据 von Neumann 稳定性分析，当 r>0.5 时，数值解的误差会在时间推进过程中不断放大，从而导致振荡发散现象。这是显式差分法固有的稳定性限制，必须满足 r≤0.5 才能保证数值解的稳定性和收敛性。

2. **如何从物理角度理解稳定性条件的含义？**
  从物理角度来看，稳定性条件 r≤0.5 反映了热传导过程中信息传播的速度限制。在一个时间步长内，热量的传播不能超过相邻的空间网格点，否则会导致数值解的不稳定。这类似于物理中的因果律，即一个点的温度变化不能瞬间影响到较远距离的点。稳定性条件确保了数值解能够正确地反映物理过程中的信息传播特性。
