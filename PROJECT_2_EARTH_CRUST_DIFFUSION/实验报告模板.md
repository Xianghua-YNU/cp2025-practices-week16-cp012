# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [请填写]

**学号：** [请填写]

**完成日期：** [请填写]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
- 空间和时间离散化方案

空间离散化：
采用均匀网格，空间步长为 h (默认值为 1.0 米)
深度范围从 0 到 20 米，分为 M 个网格点 (默认值为 21)
深度数组 depth 为 [0, h, 2h, ..., 20]

时间离散化：
采用均匀时间步长，时间步长为 a (默认值为 1.0 天)
每个时间步长与空间步长的关系由稳定性参数 $r = h * D / a²$ 决定
每年分为 N 个时间步 (默认值为 366)，模拟 years 年 (默认值为 10 年)

- 差分方程的具体形式

热传导方程的标准形式为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

使用显式差分格式离散化：

时间导数： $∂T/∂t ≈ (T(z, t+Δt) - T(z, t)) / Δt$ 

空间二阶导数： $∂²T/∂z² ≈ (T(z+Δz, t) - 2T(z, t) + T(z-Δz, t)) / (Δz)²$ 

代入原方程并整理，得到差分方程：

 $T(z, t+Δt) = T(z, t) + r * [T(z+Δz, t) - 2T(z, t) + T(z-Δz, t)]$ 

其中稳定性参数 $r = D * Δt / (Δz)²$ ，在代码中表示为 $r = h * D / a²$ 。

- 边界条件的处理方法

  上边界条件（地表）：
  温度随时间呈正弦变化： $T(0, t) = A + B * sin(2πt/TAU)$ 
  其中 $A = 10°C$ 为年平均温度， $B = 12°C$ 为温度振幅， $TAU = 365天$ 为周期
  在代码中直接赋值： $T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)$ 

  下边界条件（20米深处）：
  固定温度边界： $T(20, t) = T_BOTTOM = 11°C$ 
  在代码中直接赋值： $T[-1, :] = T_BOTTOM$ 


- 稳定性条件的考虑

显式差分格式的稳定性条件为： $r ≤ 0.5$ 
在代码中计算 $r = h * D / a²$ ，并检查是否满足稳定性条件
当 $r > 0.5$ 时，显式格式会出现数值不稳定，导致计算结果发散
可以通过减小时间步长 $a$ 或增大空间步长 $h$ 来满足稳定性条件


**稳定性分析：**

[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值

 $r$ 表示热量在一个时间步内扩散的空间范围与网格尺寸的比值
  $r$ 值越大，热量在时间步内扩散得越远
  当 $r$ 超过临界值时，数值解会出现不稳定（振荡或发散）

- 时间步长选择的限制条件

根据稳定性条件 $r \leq \frac{1}{2}$ ，可以推导出时间步长 $\Delta t$ 的限制条件：

$$\Delta t \leq \frac{(\Delta z)^2}{2D}$$

影响因素：

1. 空间步长 $\Delta z$ ：时间步长与空间步长的平方成正比；
   空间网格越细（$\Delta z$ 越小），允许的时间步长越小；
   若空间步长减半，时间步长需减小为原来的1/4。

2. 热扩散率 $D$ ：时间步长与热扩散率成反比；
   热扩散率越大，允许的时间步长越小；
   不同材料的热扩散率差异很大。

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  21
- 时间步数: $n_t$ =  366
- 模拟总时间：10年
- 稳定性参数: $r$ = 0.1

### 4.2 图表结果：季节性温度轮廓图

![屏幕截图 2025-06-11 104759](https://github.com/user-attachments/assets/51de6f26-616f-444a-872f-374edd62c156)


**图表分析：**
- 描述四个季节温度轮廓的差异

  在四个季节（冬季、春季、夏季、秋季），温度轮廓呈现以下特征：

夏季（Day 180）：

  地表温度最高，接近峰值（约 22°C）

  温度随深度迅速下降，形成明显的温度梯度

  深层温度受夏季影响较小，保持在接近年平均温度的水平

冬季（Day 0）：

  地表温度最低，接近谷值（约 - 2°C）

  温度随深度逐渐升高，深层温度高于表层

  温度梯度方向与夏季相反

春季（Day 90）和秋季（Day 270）：

  地表温度接近年平均温度（10°C）

  温度梯度较小，表层和深层温度差异不大

  春季温度从地表向下逐渐降低，秋季则相反

结论：季节性温度变化导致地表温度的周期性波动，这种波动随深度逐渐减弱。

- 分析温度振幅随深度的衰减规律

温度振幅随深度呈指数衰减，符合理论预测：

$$A(z) = A_0 \cdot e^{-z/d}$$

其中：

$A(z)$ 是深度z处的振幅

$A_0$ 是地表振幅（12°C）

$d = \sqrt{\frac{D \cdot \tau}{2\pi}}$ 是衰减长度，约为5.4米

结论：热扩散导致温度波动随深度迅速衰减，深层温度受季节性影响较小。


- 讨论季节性影响的穿透深度
  
季节性温度变化的穿透深度定义为：振幅减小到地表振幅的1/e（约37%）的深度。

根据理论公式：$d = \sqrt{\frac{D \cdot \tau}{2\pi}} \approx 5.4$ 米

数值结果显示，在约5米深度处，振幅减小到约4.4°C（约为地表振幅的37%）

穿透深度的影响因素：

  热扩散率D：D越大，穿透深度越深

  周期τ：周期越长（如年周期vs日周期），穿透深度越深


---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[分析模拟结果揭示的物理现象：]

数值模拟成功揭示了地壳热传导的基本特征：温度波动随深度指数衰减、相位延迟随深度线性增加、存在穿透深度阈值。

这些现象由热扩散方程的物理本质决定，并通过显式差分格式准确捕捉。模拟结果与理论预测高度吻合，验证了数值方法的有效性。


### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

深层温度季节性变化远小于地表的主要原因是热扩散的衰减效应。

   地表温度的周期性变化（如年周期）通过热传导向地下传播时，振幅随深度呈指数衰减。
   
   数学上，振幅衰减符合公式：
   
   $$A(z) = A_0 \cdot e^{-z/d}$$
   
   其中 $A_0$ 是地表振幅，$d = \sqrt{\frac{D \cdot \tau}{2\pi}}$ 是衰减长度（约5.4米，由热扩散率 $D$ 和周期 $\tau$ 决定）。  
   当深度 $z \approx 15$ 米时，振幅 $A(z)$ 已衰减至地表的 $e^{-15/5.4} \approx 0.06$ 倍，几乎可以忽略。


实际地球科学中的应用

1. 地温基准测量
   - 深层恒温层（约15-20米以下）的温度可作为稳定的参考基准，用于校正地表温度计的长期漂移。
   - 在气候研究中，深层温度记录可用于区分短期气候波动和长期趋势（如全球变暖信号）。

2. 地热能利用
   - 地源热泵系统利用深层恒温层的稳定性，通过地下埋管换热器与土壤进行热量交换，实现高效供暖或制冷。
   - 深层地热资源（如热水、干热岩）的开发需排除季节性温度干扰，准确评估地质热流。

3. 地质勘探与考古
   - 深层恒温层的温度可作为“热背景”，帮助识别地下异常热源（如火山活动、地下水流动）。
   - 在考古学中，通过分析古土壤的温度记录，可推断历史时期的气候变化。

4. 建筑与基础设施设计 
   - 地下建筑（如隧道、地铁）的热设计需考虑深层温度的稳定性，减少空调能耗。
   - 输油管道、电缆等地下设施的温度控制需避免受季节性波动影响。

5. 农业与生态
   - 农作物根系层（通常<1米）受季节性温度影响显著，但深层土壤温度的稳定性可提供缓冲，减少极端温度对植物的伤害。
   - 地下生态系统（如洞穴生物）依赖稳定的深层温度环境生存。

3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

显式差分格式的优势

1. 实现简单直观，差分方程直接解耦，每个时间步只需简单的代数运算：
   
     $$T(z, t+\Delta t) = T(z, t) + r \cdot [T(z+\Delta z, t) - 2T(z, t) + T(z-\Delta z, t)]$$  

2. 计算效率高
   
3. 内存占用小

选择隐式格式的情况

1. 稳定性要求高
   
   隐式格式（如Crank-Nicolson方法）无条件稳定，不受 $r \leq 0.5$ 的限制，可使用更大的时间步长 $\Delta t$。
   
   对于热扩散率 $D$ 大或空间步长 $\Delta z$ 小的问题，显式格式的时间步长需极小，导致计算量剧增，此时隐式格式更高效。

2. 长时间模拟 
   
3. 复杂边界条件

4. 高精度要求

5. 非均匀网格

---

## 6. 核心代码片段（可选）

```python
import numpy as np
import matplotlib.pyplot as plt

# 物理常数
D = 0.1  # 热扩散率 (m^2/day)
A = 10.0  # 年平均地表温度 (°C)
B = 12.0  # 地表温度振幅 (°C)
TAU = 365.0  # 年周期 (days)
T_BOTTOM = 11.0  # 20米深处温度 (°C)
T_INITIAL = 10.0  # 初始温度 (°C)
DEPTH_MAX = 20.0  # 最大深度 (m)


def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    """
    求解地壳热扩散方程 (显式差分格式)

    参数:
        h (float): 空间步长 (m)
        a (float): 时间步长比例因子
        M (int): 深度方向网格点数
        N (int): 时间步数
        years (int): 总模拟年数

    返回:
        tuple: (depth_array, temperature_matrix)
            - depth_array (ndarray): 深度数组 (m)
            - temperature_matrix (ndarray): 温度矩阵 [time, depth]
    """
    # 计算稳定性参数
    r = h * D / a ** 2
    print(f"稳定性参数 r = {r:.4f}")

    # 初始化温度矩阵
    T = np.zeros((M, N)) + T_INITIAL
    T[-1, :] = T_BOTTOM  # 底部边界条件

    # 时间步进循环
    for year in range(years):
        for j in range(1, N - 1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)

            # 显式差分格式
            T[1:-1, j + 1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2 * T[1:-1, j])

    # 创建深度数组
    depth = np.arange(0, DEPTH_MAX + h, h)

    return depth, T


def plot_seasonal_profiles(depth, temperature, seasons=[90, 180, 270, 365]):
    """
    绘制季节性温度轮廓

    参数:
        depth (ndarray): 深度数组
        temperature (ndarray): 温度矩阵
        seasons (list): 季节时间点 (days)
    """
    plt.figure(figsize=(10, 8))

    # 绘制各季节的温度轮廓
    for i, day in enumerate(seasons):
        plt.plot(depth, temperature[:, day],
                 label=f'Day {day}', linewidth=2)
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()

    plt.show()


if __name__ == "__main__":
    # 运行模拟
    depth, T = solve_earth_crust_diffusion()

    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)
```

