# 项目：热传导方程数值解法比较 - 实验报告

**学生姓名：** [代码：段林焱，报告：林郅康] 

**学号：** [段林焱：20231050098 林郅康：20231050164] 

**完成日期：** [2025.6.11]

## 1. 实验目的

本实验旨在通过实现和比较四种不同的数值方法求解一维热传导方程，深入理解偏微分方程数值解法的特点、稳定性和精度问题。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学形式为：

$$\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$$

其中：
- $u(x,t)$ 是温度分布函数
- $\alpha$ 是热扩散系数
- 边界条件： $u(0,t) = u(L,t) = 0$
- 初始条件： $u(x,0) = f(x)$

### 2.2 数值方法概述

1. **显式差分法（FTCS）**：前向时间，中心空间差分
2. **隐式差分法（BTCS）**：后向时间，中心空间差分
3. **Crank-Nicolson方法**：时间方向二阶精度的隐式方法
4. **solve_ivp方法**：将PDE转化为ODE系统求解

## 3. 算法实现

### 3.1 显式差分法

**核心思想：** 使用前向差分近似时间导数，中心差分近似空间导数。当前时间步的解直接由前一时间步的解显式计算得到。

**稳定性条件：** $r = \frac{\alpha \Delta t}{(\Delta x)^2} \leq 0.5$

**关键代码片段：**
```python
# 在此处粘贴你的核心实现代码
```
for n in range(1, nt):
    # 使用scipy.ndimage.laplace应用拉普拉斯算子
    du_dt = r * laplace(u)
    u += du_dt
    
    # 应用边界条件
    u[0] = 0.0
    u[-1] = 0.0

### 3.2 隐式差分法

**核心思想：** 使用后向差分近似时间导数，中心差分近似空间导数。需要在每个时间步求解线性方程组。

**优势：** 无条件稳定

**关键代码片段：**
```python
# 在此处粘贴你的核心实现代码
```
# 为内部节点构建三对角矩阵
num_internal = self.nx - 2
banded_matrix = np.zeros((3, num_internal))
banded_matrix[0, 1:] = -r  # 上对角线
banded_matrix[1, :] = 1 + 2*r  # 主对角线
banded_matrix[2, :-1] = -r  # 下对角线

# 求解三对角系统
u_internal_new = scipy.linalg.solve_banded((1, 1), banded_matrix, rhs)
### 3.3 Crank-Nicolson方法

**核心思想：** 时间导数的中心差分近似，是显式和隐式方法的平均，具有二阶精度。

**精度：** 时间和空间都是二阶精度

**关键代码片段：**
```python
# 在此处粘贴你的核心实现代码
```
# 左侧矩阵A
banded_matrix_A = np.zeros((3, num_internal))
banded_matrix_A[0, 1:] = -r/2  # 上对角线
banded_matrix_A[1, :] = 1 + r  # 主对角线
banded_matrix_A[2, :-1] = -r/2  # 下对角线

# 右侧向量
rhs = (r/2) * u[:-2] + (1 - r) * u_internal + (r/2) * u[2:]
### 3.4 solve_ivp方法

**核心思想：** 将偏微分方程转化为常微分方程组，使用成熟的ODE求解器

**优势：** 自适应步长，高精度

**关键代码片段：**
```python
# 在此处粘贴你的核心实现代码
```
sol = solve_ivp(
    fun=self._heat_equation_ode,
    t_span=(0, self.T_final),
    y0=u0_internal,
    method=method,
    t_eval=plot_times,
    rtol=1e-8,
    atol=1e-10
)
## 4. 实验结果

### 4.1  数值结果

#### 4.1.1 温度分布演化

[在此处插入或描述温度分布随时间演化的图像]



#### 4.1.2 计算效率比较

| 方法 | 计算时间 (秒) | 时间步数 | 效率评价 |
|------|---------------|----------|----------|
| 显式差分法 |0.0410s | 2500 | 时间步长小，效率低 |
| 隐式差分法 | 0.0047s| 250 | 时间步长较大，效率中等 |
| Crank-Nicolson | 0.0021| 50 |时间步长大，效率高 |
| solve_ivp | 0.0941 | 自适应 | 精度高但计算量较大
 |

#### 4.2.3 精度分析

以solve_ivp方法作为参考解，计算其他方法的相对误差：

| 方法 | 最大相对误差 | 平均相对误差 | 精度评价 |
|------|--------------|--------------|----------|
| 显式差分法 | 1.67e-03 | 4.07e-04 | 精度较低|
| 隐式差分法 | 1.66e-02 | 4.03e-03| 精度中等|
| Crank-Nicolson | 3.98e-01 | 8.74e-02 | 精度高|

### 4.3 稳定性验证

#### 4.3.1 显式方法稳定性

- 稳定性参数：r =
- 稳定性判断：当r>0.5时不稳定
- 观察现象：当r>0.5时解会出现振荡和发散

#### 4.3.2 隐式方法稳定性

- 大时间步长测试： $\Delta t =$ 1.0
- 稳定性表现：即使大时间步长也能保持稳定

## 5. 结果分析与讨论

### 5.1 方法比较

#### 5.1.1 精度比较

solve_ivp精度最高但计算量大

Crank-Nicolson精度接近solve_ivp但效率更高

显式方法精度最差但实现简单

#### 5.1.2 效率比较

显式方法因稳定性限制效率最低

隐式方法效率中等

Crank-Nicolson效率最高

#### 5.1.3 稳定性比较

显式方法有条件稳定

隐式方法和Crank-Nicolson无条件稳定

### 5.2 物理现象分析

#### 5.2.1 热扩散过程

初始热量从高温区域向两侧扩散，最终趋于平衡

#### 5.2.2 边界条件影响

零边界条件导致热量最终完全耗散

### 5.3 数值方法选择建议

根据实验结果，针对不同应用场景提出方法选择建议：
高精度要求：solve_ivp
快速计算：Crank-Nicolson
长时间模拟：隐式方法
实时应用：显式方法(简单实现)

6. 问题与收获

## 6. 问题与收获

### 6.1 遇到的主要问题

1. **[问题1]**：显式方法稳定性问题
解决方法：减小时间步长满足稳定性条件
经验总结：必须检查稳定性条件

2. **[问题2]**：边界条件处理
解决方法：明确区分内部节点和边界节点
经验总结：边界条件处理对结果影响很大

### 6.2 主要收获

深入理解了不同数值方法的特性和适用场景

掌握了偏微分方程数值求解的实现技巧

## 7. 思考题

### 7.1 稳定性分析

为什么显式差分法需要满足稳定性条件 $r \leq 0.5$，而隐式方法无条件稳定？请从数学角度分析。

**答案：** 显式方法稳定性条件来自算法本身的误差传播特性，而隐式方法通过求解方程组自然抑制了误差增长。

7.2 精度提升
### 7.2 精度提升

如何进一步提高数值解的精度？请提出至少两种方法并说明原理。

**答案：** 减小网格尺寸Δx

使用更高阶的差分格式

### 7.3 实际应用

在实际工程问题中，如何根据具体需求选择合适的数值方法？

**答案：** [你的思考]

### 7.4 扩展问题

如果要求解二维或三维热传导方程，各种方法的优缺点会如何变化？

**答案：** [你的分析]

## 8. 完整代码

[如果需要，可以在此处附上完整的实现代码]


